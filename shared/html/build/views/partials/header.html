<nav class="navbar navbar-default navbar-fixed-top">
    <div class="gradient"></div>
    <div class="container-fluid " ng-init="getNotifications()">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">            
            <a class="navbar-brand" href="javascript:void(0)" ng-click="redirectPath('all','/contacts')">
                <div class="company-logo">
                    <div class="logo icon-ic_mycontacts q-icon"></div>
                    <div class="logo-title">{{'MY_CONTACTS' | translate}}</div>
                    <div class="nas-info">
                        <div>{{nasDetails.nas_name}}</div>
                        <div>IP: {{nasDetails.hostname}}</div>
                   </div>
                </div>
            </a>           
        </div>

        <ul  ng-hide="is_login_page" class="nav navbar-nav navbar-right left-navigation">
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="icon-framset_more_normal q-icon"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li class="dropdown-submenu pull-left">
                        <a tabindex="-1" href="javascript:void(0)">{{'CHOOSE_LANGUAGE' | translate}}</a>
                        <ul class="dropdown-menu" role="menu">
                            <li ng-repeat="language in supportedLanguages" ng-click="changeLanguage(language.lang_code)"><a href="javascript:void(0)">{{language.lang_name}}</a></li>
                        </ul>
                    </li>
                    <li><a href="{{api_url}}docs" target="_blank">{{'API_DOC' | translate}}</a></li>
                    <li ng-click="openAbout()"><a href="javascript:void(0)">{{'ABOUT' | translate}}</a></li>
                    <li ng-click="openHelp();"><a href="javascript:void(0)">{{'HELP' | translate}}</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">{{userDetails.username}} <span class="caret"></span></a>
                <ul class="dropdown-menu">
                    <li ng-if="userDetails.username == 'admin'"><a href="javascript:void(0)" ng-click="openUserManagement()">{{'USER_MANAGEMENT' | translate}}</a></li>
                    <!--<li ng-if="userDetails.role != 'admin'"><a href="javascript:void(0)" ng-click="openEditProfile()">{{'EDIT_PROFILE' | translate}}</a></li>-->
                    <li><a href="javascript:void(0)" ng-click="openResetHighSecurityPassword()">{{'HIGH_SECURITY_PASSWORD' | translate}}</a></li>
                    <li role="separator" class="divider"></li>
                    <li><a href="javascript:void(0)" ng-click="logout()">{{'LOGOUT' | translate}}</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span title="{{'BACKGROUND_TASK' | translate}}" class="icon-framset_bg_task_normal q-icon"></span><div ng-if="tasks.length > 0" class="bg-task-count">{{tasks.length}}</div></a>

                <ul id="notifications" class="dropdown-menu">
                    <li style=" " class="header" >
                        <div class="notification-header-content">
                            {{'BACKGROUND_TASK' | translate}}
                        </div>
                    </li>
                    <hr class="notification-hr" />

                    <li ng-if="tasks.length < 1"><center><img src="resources/img/framset_bg_task_normal.png"><br/>{{'NO_TASKS_ARE_RUNNING' | translate}}</center></li>
                    
                    <li class="notification-content" ng-if="tasks.length > 0">
                        <ul>
                            <div ng-repeat="task in tasks">                                
                                <li  class="notification-data-bar" style="border-bottom: 1px solid #aeaeae;">
                                    <div class="content left" style="width:90%">
                                        <div class="description">
                                            {{task.name}}
                                        </div>
                                        <div class="date"> 
                                            <uib-progressbar class="progress-striped" value="task.progress">{{task.progress}}<span ng-if="task.progress!='Waiting'">%</span></uib-progressbar>
                                        </div>
                                    </div>
                                    <div class="clear"></div>                        
                                </li>
                            </div>
                        </ul>
                    </li>             
                </ul>
            </li>
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                    <span class="icon-framset_notify">&nbsp;</span><div ng-if="notifications.current_count > 0" class="notification-count">{{notifications.current_count}}</div>
                </a>
                <ul id="notifications" class="dropdown-menu">
                    <li style=" " class="header" >
                        <div class="notification-header-content">
                            {{'NOTIFICATIONS' | translate}}
                        </div>
                    </li>
                    <hr class="notification-hr" />

                    <li ng-if="notifications.current_count < 1"><center><img src="resources/img/ic_delete_letters.png"><br/>{{'NO_NOTIFICATIONS' | translate}}</center></li>
                    
                    <li class="notification-content" ng-if="notifications.current_count > 0">
                        <ul>
                            <div ng-repeat="notification in notifications.data | orderBy:'_id':true">
                                <li class="notification-data-bar notification-data" ng-if="notification.type=='export'">
                                    <a  href="{{api_url}}download?type=export&filename={{notification.message.filename}}&authorization={{authorization}}" downlaod>
                                        <div class="left notification-icon">
                                            <img src="./resources/img/notification_bulb.png" alt="image">
                                        </div>
                                        <div class="content left">
                                            <div class="description">
                                                <span>{{notification.key | translate}} {{": "+notification.import_from}}</span>
                                            </div>
                                            <div class="date"> 
                                                <span>{{notification.logged_on | date:'yyyy/MM/dd HH:mm:ss'}}</span>
                                            </div>    
                                        </div>
                                        <div class="right">
                                            <img src="./resources/img/download_normal.png" alt="image">
                                        </div>
                                        <div class="clear"></div>
                                    </a>
                                </li>
                                <li ng-if="notification.type!='export'" class="notification-data-bar notification-data">
                                    <div class="left notification-icon">
                                        <img src="./resources/img/notification_bulb.png" alt="image">
                                    </div>
                                    <div class="content left">
                                        <div class="description">
                                            <span>{{ notification.key | translate}} {{": "+notification.import_from}}</span>
                                        </div>
                                        <div class="date"> 
                                            <span>{{notification.logged_on | date:'yyyy/MM/dd HH:mm:ss'}}</span>
                                        </div>    
                                    </div>
                                    <div ng-click="showPreview(notification.general_data.transaction_id)" ng-if="notification.key =='NOTIFICATION_IMPORT_TEMP'" class="right icon-eye_active">
                                    </div>
                                    <div class="clear"></div>                        
                                </li>
                            </div>
                        </ul>
                    </li>

                    <li ng-if="notifications.current_count > 0" class="notification-data-bar notification-action" >                        
                        <div class="notification-clear-all right">
                            <button ng-click="clearAllNotifications()">{{'CLEAR_ALL' | translate}}</button>                             
                        </div>
                        <div class="clear"></div>
                    </li>                    
                </ul>
            </li>

            <li class="dropdown search-button">
                <div id="searchBarDiv" class="search-bar" click-outside="closeSearch()">
                    <div id="search-inputs">
                        <input type="text" ng-blur="showSearchResult=false" id="search_string" placeholder="{{'ENTER_KEYWORDS' | translate}}" ng-model="search.s" ng-keyup="cleanUpSearch(search)" ng-change="showSearchResult=true;doSearch(search)" ng-keypress="($event.which === 13)?applyFilter(search):0;($event.which === 13)?showSearchResult=!showSearchResult:0">
                        <span ng-dropdown-multiselect="" options="searchCriteria" selected-model="searchCriteriaModel" translation-texts="translationText" extra-settings="searchCriteriaSettings" checkboxes="true"></span>
                        <div class="search-result list-group" ng-if="searchedContacts.length>0" ng-show="showSearchResult">
                            <a href="javascript:void(0)" class="list-group-item" ng-repeat="opt in searchedContacts" ng-mousedown="redirectPath('', '/contacts/edit/'+opt._id)">
                                <div class="search-profile">
                                    <div class="search-profile-pic">
                                        <img height="35" width="35" src="{{pic_url}}{{opt.profile_pic}}">
                                    </div>
                                    <div class="search-profile-name">{{opt.fname}} {{opt.lname}}</div>
                                    <div class="search-profile-email">{{opt.emails[0].value}}</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <span id="search-btn" class="icon-framset_search_active q-icon" ng-click="applyFilter(search)"></span>
                </div>
                <div class="clear"></div>
            </li>
        </ul>
    </div>
</nav>